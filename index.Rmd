---
title: "Bridging the Evidence Gap in Regenerative Agriculture"
output:
  html_document:
    selfcontained: true
---

```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = TRUE,
               out.width = "75%", 
               fig.align = "center", 
               warning = FALSE, 
               message = FALSE) 

library(akima)
library(decisionSupport)
library(ggstance)
library(gtExtras)
library(patchwork)
library(plotly)
library(rPref)
library(svglite)
library(tidyverse)

```

We model a decision impact pathway of  RA VBA  (Whitney et al. 2025). 


![](figures/dag.jpg)

**Conceptual model of RA VBA**

# Urban Hanoi school garden 

Simulation of  RA VBA:

```{r mcsimulation, warning=FALSE, message=FALSE}
# Source our model
source("vba_model_kenya.R")

# ---- 3. RUN THE MONTE CARLO SIMULATION ----
set.seed(42)  # For reproducible results

# Run the simulation 10,000 times

simulation_results <- mcSimulation(
  estimate = estimate_read_csv("data/inputs_vba_kenya.csv"),
  model_function = vba_yield_impact_25yr,
  numberOfModelRuns = 1e4, #run 10,000 times
  functionSyntax = "plainNames"
)

```

The Net Present Value (i.e. current value of the future benefits) of the garden decision options. Here we plot the distribution for the VBA and frame the projected NPV. 

```{r plot_dist_public, warning=FALSE, message=FALSE}
source("functions/plot_distributions.R")
plot_distributions(mcSimulation_object = simulation_results, 
                                    vars = "NPV_Comparative",
                   old_names = "NPV_Comparative",
                   new_names = "Gains compared to the baseline",
                                    method = 'smooth_simple_overlay', 
                                    base_size = 7, 
                                    x_axis_name = "Comparative NPV outcomes")
```

## Results: Economic Viability of the VBA Intervention

The simulation results indicate that **the proposed VBA program is not currently projected to be an economically viable investment** under the baseline assumptions.

The net present value (NPV) analysis comparing the VBA scenario to a baseline (no intervention) shows a **mean loss of `r round(mean(simulation_results$y[, "NPV_Comparative"]) / 1000, 1)` KES per hectare** over 25 years. The 90% confidence interval ranges from a loss of `r round(quantile(simulation_results$y[, "NPV_Comparative"], 0.05) / 1000, 1)` KES/ha to a gain of `r round(quantile(simulation_results$y[, "NPV_Comparative"], 0.95) / 1000, 1)` KES/ha, indicating high uncertainty. The probability of achieving a positive NPV is low, at only `r round(mean(simulation_results$y[, "NPV_Comparative"] > 0) * 100, 1)`%.

This negative return is driven by the model's prediction that the VBA program leads to only a modest increase in Regenerative Agriculture (RA) adoption, from `r round(mean(simulation_results$y[, "Final_Adoption_Baseline"]), 1)`% to `r round(mean(simulation_results$y[, "Final_Adoption_VBA"]), 1)`%, resulting in an average annual yield increase of just `r round(mean(simulation_results$y[, "Yield_Increase"]), 2)` tons/ha. These benefits are insufficient to offset the combined costs of running the VBA program and farmers' costs of adopting new practices, resulting in a negative estimated return on investment (ROI) of `r round(mean(simulation_results$y[, "ROI"]), 2)`.

*This analysis suggests that for the program to be economically sustainable, key parameters such as VBA effectiveness, yield benefits from RA practices, or program costs would need to be significantly different from the current estimates.*
